function preload(){game.load.image("space","assets/space.jpg"),game.load.image("bullet","http://img2.wikia.nocookie.net/__cb20121009064131/pockiepirate/images/9/99/Basic_Energy_Ball.png"),game.load.image("ship","assets/ship.png"),game.load.image("obstacle","http://www.heruraha.net/download/file.php?avatar=22688_1343737809.png"),game.load.image("bonus","https://wiki.cam.ac.uk/wiki/university-map/img_auth.php/4/48/Block.png"),game.load.spritesheet("kaboom","http://fc02.deviantart.net/fs71/f/2013/010/9/f/explosion_spritesheet_for_games_by_gintasdx-d5r28q5.png",128,128),game.load.audio("guile",["assets/audio/guilestheme2.ogg","assets/audio/guilestheme2.mp3"]),game.load.audio("hurt",["assets/audio/flappyhit.ogg"]),game.stage.disableVisibilityChange=!0,game.load.image("start","https://cdn0.iconfinder.com/data/icons/mobile-development-icons/128/Start.png",270,180),game.load.image("reset","http://www.level0.ch/mt/img/Sync%20Services%20Icon.png",270,180)}function create(){function a(){game.paused&&(game.paused=!1,menu.destroy(),createObstacles())}space=game.add.tileSprite(0,0,game.width,game.height,"space"),game.physics.enable(space,Phaser.Physics.ARCADE),space.autoScroll(0,400),game.renderer.clearBeforeRender=!1,game.renderer.roundPixels=!0,music=game.add.audio("guile"),music.loop=!0,music.play(),hurtSnd=game.add.audio("hurt"),game.physics.startSystem(Phaser.Physics.ARCADE),bullets=game.add.group(),bullets.enableBody=!0,bullets.physicsBodyType=Phaser.Physics.ARCADE,bullets.setAll("outOfBoundsKill",!0),bullets.createMultiple(40,"bullet"),bullets.setAll("anchor.x",-.3),bullets.setAll("anchor.y",.2),player=game.add.sprite(400,750,"ship"),player.anchor.set(.5),obstacles=game.add.group(),obstacles.enableBody=!0,obstacles.physicsBodyType=Phaser.Physics.ARCADE,createObstacles(),bonuses=game.add.group(),bonuses.enableBody=!0,bonuses.physicsBodyType=Phaser.Physics.ARCADE,createBonus(),scoreString="Score : ",scoreText=game.add.text(10,10,scoreString+score,{font:"34px Arial",fill:"#fff"}),highscoreString="High Score: ",highscoreText=game.add.text(10,70,highscoreString+localStorage.getItem("highscore"),{font:"34px Arial",fill:"#fff"}),levelString="Level : ",levelText=game.add.text(10,40,levelString+level,{font:"34px Arial",fill:"#fff"}),game.physics.enable(player,Phaser.Physics.ARCADE),player.body.drag.set(100),player.body.maxVelocity.set(500),explosions=game.add.group(),explosions.createMultiple(5,"kaboom"),explosions.forEach(setupObstacle,this),explosions.forEach(setupPlayer,this),cursors=game.input.keyboard.createCursorKeys(),game.input.keyboard.addKeyCapture([Phaser.Keyboard.SPACEBAR]),gameStarted||(game.paused=!0,menu=game.add.sprite(400,400,"start"),menu.anchor.setTo(.5,.5)),game.input.onTap.addOnce(a,self)}function reset(){restartGame.destroy(),gameStarted=!0,gameOver=!1,score=0,level=1,bulletTime=0,i=0,speed=700,time=200,obstacles.removeAll(),game.state.restart()}function createObstacles(){function a(){setTimeout(function(){if(level%2==0)var b=obstacles.create(Math.floor(800*Math.random())+1,-100,"bonus");else var b=obstacles.create(Math.floor(800*Math.random())+1,-100,"obstacle");b.anchor.setTo(.5,.5),b.body.velocity.y=speed,i++,game.paused||(i%50==0?(6e3>speed&&(speed+=100,level+=1,levelText.text=levelString+level),time>10&&(time-=10),gameOver||a()):gameOver||(console.log("PLEASE WORK"),a()))},time)}gameOver||a()}function createBonus(){function a(){setTimeout(function(){var b=bonuses.create(Math.floor(700*Math.random())+50,-20,"bonus");b.anchor.setTo(.5,.5),b.body.velocity.y=400,game.paused||(console.log("testing"),gameOver?b.kill():a())},4e3)}console.log("this should be working"),gameOver?bonus.kill():a()}function setupObstacle(a){a.anchor.x=.4,a.anchor.y=.3,a.animations.add("kaboom")}function setupBonus(a){a.anchor.x=.4,a.anchor.y=.3,a.animations.add("bonus")}function setupPlayer(a){a.anchor.x=.4,a.anchor.y=.3,a.animations.add("kaboom")}function update(){player.alive&&(player.body.velocity.setTo(0,0),cursors.left.isDown?player.body.velocity.x=-1200:cursors.right.isDown&&(player.body.velocity.x=1200),player.body.collideWorldBounds=!0,game.input.keyboard.isDown(Phaser.Keyboard.SPACEBAR)&&fireBullet()),game.physics.arcade.collide(player),game.physics.arcade.overlap(bullets,obstacles,collisionHandler,null,this),game.physics.arcade.overlap(bullets,bonuses,bulletHitsBonus,null,this),game.physics.arcade.overlap(obstacles,player,obstacleHitsPlayer,null,this),game.physics.arcade.overlap(bonuses,player,bonusHitsPlayer,null,this)}function collisionHandler(a,b){a.kill(),b.kill(),score+=10,scoreText.text=scoreString+score;var c=explosions.getFirstExists(!1);c.reset(b.body.x,b.body.y),c.play("kaboom",50,!1,!0)}function bulletHitsBonus(a,b){a.kill(),b.kill(),score+=200,scoreText.text=scoreString+score;var c=explosions.getFirstExists(!1);c.reset(b.body.x,b.body.y),c.play("kaboom",50,!1,!0)}function obstacleHitsPlayer(a,b){a.kill(),b.kill(),hurtSnd.play();var c=explosions.getFirstExists(!1);c.reset(a.body.x,a.body.y),c.play("kaboom",50,!1,!0),setGameOver(),score>localStorage.getItem("highscore")&&localStorage.setItem("highscore",score),(gameOver=!0)&&(restartGame=game.add.sprite(400,400,"reset"),restartGame.anchor.setTo(.5,.5),game.input.onTap.addOnce(reset,this))}function bonusHitsPlayer(a,b){a.kill(),b.kill(),hurtSnd.play();var c=explosions.getFirstExists(!1);c.reset(a.body.x,a.body.y),c.play("kaboom",50,!1,!0),setGameOver(),score>localStorage.getItem("highscore")&&localStorage.setItem("highscore",score),(gameOver=!0)&&(restartGame=game.add.sprite(400,400,"reset"),restartGame.anchor.setTo(.5,.5),game.input.onTap.addOnce(reset,this))}function fireBullet(){var a=100;game.time.now>bulletTime&&(bullet=bullets.getFirstExists(!1),bullet&&(bullet.reset(player.body.x+16,player.body.y+16),bullet.lifespan=1400,bullet.body.velocity.y=-500,a>=40&&level%5==0&&(a-=20),bulletTime=game.time.now+a))}function resetBullet(a){a.kill()}function setGameOver(){gameOver=!0,music.stop(),console.log("This appears")}function render(){}var game=new Phaser.Game(800,800,Phaser.CANVAS,"project4-game",{preload:preload,create:create,update:update,render:render}),space,player,obstacles,bonuses,cursors,music,explosions,score=0,highscore=0,scoreString="",highscoreString="",scoreText,highscoreText,level=1,levelString="",levelText,bullet,bullets,bulletTime=0,particles,textureRegistry={},gameOver=!1,i=0,speed=700,time=200,gameStarted=!1;angular.module("myApp",[]).controller("myController",["$scope","helper",function(a,b){b.sayHi,a.user={name:"Alfredo",sex:"male"}}]).service("helper",function(){return{sayHi:console.log("hi")}});